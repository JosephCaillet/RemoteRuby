// Generated by CoffeeScript 1.9.3
(function() {
  var Ruby, codeAlwaysExecuted, http, io, ruby, server;

  http = require('http');

  io = require('socket.io');

  Ruby = require('./RubyCodeLauncher');

  codeAlwaysExecuted = "STDOUT.sync = true";

  server = http.createServer();

  io = io.listen(server);

  ruby = new Ruby;

  io.sockets.on('connection', function(socket) {
    ruby.setSocket(socket);
    socket.on('run', function(code) {
      return ruby.start(codeAlwaysExecuted + "\n" + code);
    });
    socket.on('stop', function() {
      return ruby.stop();
    });
    return socket.on('stdin', function(input) {
      return ruby.stdin(input);
    });
  });

  server.listen(8080, 'localhost');

}).call(this);
